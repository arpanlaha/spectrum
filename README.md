# Spectrum

Randomly-generated art using Rust + WebAssembly.

![Spectrum](https://user-images.githubusercontent.com/32147742/85253776-8451d800-b424-11ea-818d-a596c460c307.png)

## Background

The patterns generated by Spectrum are inspired by my submission to [CS 225's MP1 Part 3](https://courses.engr.illinois.edu/cs225/fa2018/mps/1/#part-3-getting-creative), which invovles using the [HSL color space](https://en.wikipedia.org/wiki/HSL_and_HSV) to generate artwork.

Spectrum uses three different rendering methods:

- WebGL + WebAssembly
- WebAssembly only (`2d` canvas rendering context)
- JavaScript only (`2d` canvas rendering context)

This originated as a way for me to test out Rust with WebAssembly, but after seeing the limitations of a CPU-only render (the WebAssembly-only implementation), I decided to try out implementing the same logic in WebGL to better understand the benefits of GPU-accelerated rendering. To illustrate the benefits of WebAssembly, I also created the JavaScript-only implementation as a comparison.

## Algorithm

For a given canvas, a number of "sources" is assigned. Each source is assigned a random position (x/y) that falls within the canvas, and a random hue value in the HSL color space. Every pixel in the canvas is colored according to a weighted average of distance from each source, using the inverse squared distance from each source as the weighting factor (with a small constant added value to avoid dividing by zero).

However, as hue is a periodic/circular metric, weighting by mean will yield incorrect results. For example (in degrees), the mean of hues 10 and 350 will be 180, while the actual average hue will be 0. To account for this, each source's hue is broken in to sine and cosine components which are summed to reach a total. The arctangent is then applied to the total to calculate the resulting hue.

## References

Spectrum draws heavily from the following examples:

- [The Rust and WebAssembly Game of Life Tutorial](https://rustwasm.github.io/book/game-of-life/introduction.html)
- [The `web-sys` WebGL Example](https://rustwasm.github.io/wasm-bindgen/examples/webgl.html)

A formula from the [IEEE Signal Processing Magazine](http://www-labs.iro.umontreal.ca/~mignotte/IFT2425/Documents/EfficientApproximationArctgFunction.pdf) is also used as a faster alternative to Rust's standard library arctangent function.
